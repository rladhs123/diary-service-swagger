---
openapi: 3.1.0
info:
  title: 그림일기 API 명세서
  description: AI 그림일기 생성 서비스 API 문서입니다.
  version: v1
servers:
- url: http://localhost:8080
  description: Generated server url
security:
- BearerAuth: []
tags:
- name: 1. Auth API
  description: 인증 (회원가입, 로그인) 관련 API
- name: 2. Diary API
  description: 그림일기 (생성/조회) 관련 API
paths:
  "/diaries/generate-images":
    post:
      tags:
      - 2. Diary API
      summary: 그림일기 생성 (핵심)
      description: 일기 내용(content)을 받아 AI가 3개의 이미지 URL을 생성하고 DB에 저장합니다. (JWT 인증 필요)
      operationId: generateDiaryImages
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/DiaryCreateRequestDto"
        required: true
      responses:
        '200':
          description: 생성 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
              examples:
                3개 URL 예시:
                  description: 3개 URL 예시
                  value:
                  - https://storage.googleapis.com/diary-image-bucket/generated-image/1.png
                  - https://storage.googleapis.com/diary-image-bucket/generated-image/2.png
                  - https://storage.googleapis.com/diary-image-bucket/generated-image/3.png
  "/auth/signup":
    post:
      tags:
      - 1. Auth API
      summary: 회원가입
      description: 이메일, 비밀번호로 회원가입을 진행합니다.
      operationId: signUp
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/SignUpRequest"
        required: true
      responses:
        '200':
          description: OK
          content:
            "*/*":
              schema:
                type: object
  "/auth/refresh":
    post:
      tags:
      - 1. Auth API
      summary: 토큰 갱신
      description: Refresh 토큰으로 새 Access/Refresh 토큰을 발급받습니다.
      operationId: refresh
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/RefreshRequest"
        required: true
      responses:
        '200':
          description: OK
          content:
            "*/*":
              schema:
                "$ref": "#/components/schemas/TokenResponse"
  "/auth/logout":
    post:
      tags:
      - 1. Auth API
      summary: 로그아웃
      description: 서버에서 Refresh 토큰을 만료시킵니다. (Access 토큰 필요)
      operationId: logout
      parameters:
      - name: Authorization
        in: header
        required: true
        schema:
          type: string
      responses:
        '200':
          description: OK
          content:
            "*/*":
              schema:
                type: object
  "/auth/login":
    post:
      tags:
      - 1. Auth API
      summary: 로그인
      description: 로그인 성공 시 Access/Refresh 토큰을 반환합니다.
      operationId: login
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/LoginRequest"
        required: true
      responses:
        '200':
          description: OK
          content:
            "*/*":
              schema:
                "$ref": "#/components/schemas/TokenResponse"
components:
  schemas:
    DiaryCreateRequestDto:
      type: object
      properties:
        content:
          type: string
    SignUpRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          minLength: 1
        password:
          type: string
          maxLength: 100
          minLength: 8
      required:
      - email
      - password
    RefreshRequest:
      type: object
      properties:
        refreshToken:
          type: string
          minLength: 1
      required:
      - refreshToken
    TokenResponse:
      type: object
      properties:
        accessToken:
          type: string
        refreshToken:
          type: string
    LoginRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          minLength: 1
        password:
          type: string
          minLength: 1
      required:
      - email
      - password
  securitySchemes:
    BearerAuth:
      type: http
      name: Authorization
      in: header
      scheme: bearer
      bearerFormat: JWT
